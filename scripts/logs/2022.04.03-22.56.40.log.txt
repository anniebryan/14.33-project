-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/logs/2022.04.03-22.56.40.log.txt
  log type:  text
 opened on:   3 Apr 2022, 22:56:40

. 
. ssc install estout, replace
checking estout consistency and verifying not already installed...
all files already exist and are up to date.

. ssc install outreg2
checking outreg2 consistency and verifying not already installed...
all files already exist and are up to date.

. 
. * Stata version control
. version 17

. 
. * Create directories for output files
. cap mkdir "$MyProject/processed"

. cap mkdir "$MyProject/processed/intermediate"

. cap mkdir "$MyProject/results"

. cap mkdir "$MyProject/results/figures"

. cap mkdir "$MyProject/results/intermediate"

. cap mkdir "$MyProject/results/tables"

. 
. * Run project analysis
. do "$MyProject/scripts/1_process_data.do"

. ************
. * SCRIPT: 1_process_data.do
. * PURPOSE: imports the raw datasets and converts them into a stata-readable format
. ************
. 
. // MA zoning data
. insheet using "$MyProject/data/ma-zoning-laws/ma-zoning-laws.csv", comma clear
(3 vars, 352 obs)

. compress
  (0 bytes saved)

. save "$MyProject/processed/intermediate/ma_zoning_laws_uncleaned.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/ma_zoning_laws_uncleaned.dta saved

. 
. // US states legality data
. insheet using "$MyProject/data/us-states-legality.csv", comma clear
(6 vars, 51 obs)

. compress
  (0 bytes saved)

. save "$MyProject/processed/us_states_legality.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/us_states_legality.dta saved

. 
. // MA dispensaries data
. insheet using "$MyProject/data/dispensaries.csv", comma clear
(66 vars, 887 obs)

. compress
  (0 bytes saved)

. save "$MyProject/processed/intermediate/dispensaries_uncleaned.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/dispensaries_uncleaned.dta saved

. 
. // MA property assessments data
. forvalues y = 2014/2021 {
  2.         insheet using "$MyProject/data/property_assessment/property-assessment-fy`y'.csv", comma clear
  3.         compress
  4.         save "$MyProject/processed/intermediate/property_assessments_ma_`y'_uncleaned.dta", replace
  5. }
(56 vars, 164,091 obs)
  variable st_name was str25 now str24
  variable u_heat_typ was str2 now str1
  (328,182 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2014_uncleaned.dta saved
(56 vars, 168,115 obs)
  variable st_name was str25 now str24
  variable st_name_suf was str4 now str3
  variable full_address was str55 now str48
  variable u_heat_typ was str2 now str1
  (1,681,150 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2015_uncleaned.dta saved
(77 vars, 169,199 obs)
  variable st_name was str25 now str24
  variable st_name_suf was str4 now str3
  (338,398 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2016_uncleaned.dta saved
(75 vars, 170,910 obs)
  variable st_name was str25 now str24
  variable st_name_suf was str4 now str3
  (341,820 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2017_uncleaned.dta saved
(75 vars, 172,841 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2018_uncleaned.dta saved
(75 vars, 174,668 obs)
  variable st_name was str25 now str24
  variable st_name_suf was str4 now str3
  (349,336 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2019_uncleaned.dta saved
(75 vars, 175,052 obs)
  variable st_name_suf was str5 now str4
  (175,052 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2020_uncleaned.dta saved
(63 vars, 177,091 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2021_uncleaned.dta saved

. 
. // Zillow home value data
. insheet using "$MyProject/data/zhvi_sa_35_65.csv", comma clear
(274 vars, 30,468 obs)

. compress
  (0 bytes saved)

. save "$MyProject/processed/intermediate/zillow_home_values_uncleaned.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/zillow_home_values_uncleaned.dta saved

. 
. // Boston crash data
. forvalues y = 2008/2021 {
  2.         insheet using "$MyProject/data/boston-crashes/`y'_Crashes.csv", comma clear
  3.         compress
  4.         save "$MyProject/processed/intermediate/crashes_boston_`y'_uncleaned.dta", replace
  5. }
(117 vars, 136,384 obs)
  variable rdwy was str105 now str104
  variable non_mtrst_type_cl was str78 now str77
  variable non_mtrst_loc_cl was str150 now str149
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str52 now str51
  (681,920 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2008_uncleaned.dta saved
(115 vars, 117,776 obs)
  variable rdwy was str119 now str118
  variable near_int_rdwy was str50 now str49
  variable exit_rte was str5 now str4
  variable non_mtrst_type_cl was str118 now str117
  variable non_mtrst_actn_cl was str136 now str135
  variable non_mtrst_loc_cl was str146 now str145
  variable rmv_doc_ids was str66 now str65
  variable crash_rpt_ids was str70 now str69
  variable tostreetname was str56 now str55
  (1,059,984 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2009_uncleaned.dta saved
(115 vars, 115,643 obs)
  variable rdwy was str124 now str123
  variable non_mtrst_type_cl was str83 now str82
  variable non_mtrst_actn_cl was str182 now str181
  variable non_mtrst_loc_cl was str154 now str153
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str50 now str49
  (693,858 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2010_uncleaned.dta saved
(115 vars, 120,632 obs)
  variable vehc_seq_events_cl was str727 now str726
  variable rdwy was str126 now str125
  variable near_int_rdwy was str50 now str49
  variable mm_rte was str6 now str5
  variable non_mtrst_type_cl was str91 now str90
  variable non_mtrst_actn_cl was str136 now str135
  variable non_mtrst_loc_cl was str115 now str114
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str63 now str62
  variable tostreetname was str56 now str55
  (1,206,320 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2011_uncleaned.dta saved
(115 vars, 122,646 obs)
  variable rdwy was str125 now str124
  variable near_int_rdwy was str50 now str49
  variable non_mtrst_type_cl was str83 now str82
  variable non_mtrst_loc_cl was str154 now str153
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str62 now str61
  (735,876 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2012_uncleaned.dta saved
(115 vars, 125,285 obs)
  variable vehc_seq_events_cl was str1128 now str1127
  variable drvr_cntrb_circ_cl was str512 now str511
  variable rdwy was str128 now str127
  variable near_int_rdwy was str52 now str51
  variable non_mtrst_type_cl was str88 now str87
  variable non_mtrst_actn_cl was str182 now str181
  variable non_mtrst_loc_cl was str115 now str114
  variable rmv_doc_ids was str100 now str99
  variable crash_rpt_ids was str94 now str93
  variable drvr_distracted_cl was str145 now str144
  variable fromstreetname was str43 now str42
  (1,378,135 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2013_uncleaned.dta saved
(115 vars, 130,233 obs)
  variable rdwy was str143 now str142
  variable non_mtrst_type_cl was str83 now str82
  variable non_mtrst_actn_cl was str182 now str181
  variable non_mtrst_loc_cl was str154 now str153
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str63 now str62
  variable drvr_distracted_cl was str182 now str181
  variable tostreetname was str56 now str55
  (1,041,864 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2014_uncleaned.dta saved
(115 vars, 139,050 obs)
  variable rdwy was str143 now str142
  variable near_int_rdwy was str50 now str49
  variable non_mtrst_type_cl was str100 now str99
  variable non_mtrst_loc_cl was str134 now str133
  variable rmv_doc_ids was str66 now str65
  variable crash_rpt_ids was str62 now str61
  (834,300 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2015_uncleaned.dta saved
(115 vars, 143,474 obs)
  variable rdwy was str138 now str137
  variable near_int_rdwy was str52 now str51
  variable non_mtrst_type_cl was str82 now str81
  variable non_mtrst_actn_cl was str182 now str181
  variable non_mtrst_loc_cl was str154 now str153
  variable rmv_doc_ids was str151 now str150
  variable crash_rpt_ids was str160 now str159
  variable drvr_distracted_cl was str194 now str193
  (1,147,792 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2016_uncleaned.dta saved
(115 vars, 145,068 obs)
  variable drvr_cntrb_circ_cl was str512 now str511
  variable rdwy was str149 now str148
  variable near_int_rdwy was str52 now str51
  variable non_mtrst_type_cl was str170 now str169
  variable non_mtrst_actn_cl was str182 now str181
  variable non_mtrst_loc_cl was str210 now str209
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str73 now str72
  variable drvr_distracted_cl was str228 now str227
  (1,305,612 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2017_uncleaned.dta saved
(117 vars, 142,272 obs)
  variable rdwy was str114 now str113
  variable near_int_rdwy was str52 now str51
  variable non_mtrst_type_cl was str83 now str82
  variable non_mtrst_actn_cl was str182 now str181
  variable non_mtrst_loc_cl was str154 now str153
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str73 now str72
  (995,904 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2018_uncleaned.dta saved
(117 vars, 140,939 obs)
  variable rdwy was str129 now str128
  variable near_int_rdwy was str53 now str52
  variable non_mtrst_type_cl was str70 now str69
  variable non_mtrst_actn_cl was str136 now str135
  variable non_mtrst_loc_cl was str115 now str114
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str63 now str62
  (986,573 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2019_uncleaned.dta saved
(116 vars, 100,724 obs)
  variable vehc_seq_events_cl was str815 now str814
  variable rdwy was str125 now str124
  variable near_int_rdwy was str52 now str51
  variable non_mtrst_type_cl was str66 now str65
  variable non_mtrst_actn_cl was str136 now str135
  variable non_mtrst_loc_cl was str115 now str114
  variable rmv_doc_ids was str100 now str99
  variable crash_rpt_ids was str88 now str87
  (805,792 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2020_uncleaned.dta saved
(115 vars, 123,064 obs)
  variable rdwy was str118 now str117
  variable near_int_rdwy was str52 now str51
  variable non_mtrst_type_cl was str66 now str65
  variable non_mtrst_loc_cl was str115 now str114
  variable rmv_doc_ids was str83 now str82
  variable crash_rpt_ids was str98 now str97
  variable lclty_name was str15 now str13
  (984,512 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_boston_2021_uncleaned.dta saved

. 
. // US crash data
. insheet using "$MyProject/data/fars_nhtsa_fatality_rates_by_state.csv", comma clear
(56 vars, 53 obs)

. compress
  (0 bytes saved)

. save "$MyProject/processed/intermediate/crashes_us_uncleaned.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crashes_us_uncleaned.dta saved

. 
. // Boston crime data
. forvalues y = 2015/2022 {
  2.         insheet using "$MyProject/data/crime-incident-reports/crime-incident-reports-`y'.csv", comma clear
  3.         compress
  4.         save "$MyProject/processed/intermediate/crime_boston_`y'_uncleaned.dta", replace
  5. }
(17 vars, 53,597 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_boston_2015_uncleaned.dta saved
(17 vars, 99,430 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_boston_2016_uncleaned.dta saved
(17 vars, 101,338 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_boston_2017_uncleaned.dta saved
(17 vars, 98,888 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_boston_2018_uncleaned.dta saved
(17 vars, 87,184 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_boston_2019_uncleaned.dta saved
(17 vars, 70,894 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_boston_2020_uncleaned.dta saved
(17 vars, 71,721 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_boston_2021_uncleaned.dta saved
(17 vars, 14,650 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_boston_2022_uncleaned.dta saved

. 
. // Offense codes for Boston crime data
. import excel "$MyProject/data/rmsoffensecodes.xlsx", clear
(2 vars, 577 obs)

. compress
  (0 bytes saved)

. save "$MyProject/processed/intermediate/offense_codes.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/offense_codes.dta saved

. 
. // US crime data
. forvalues y = 2008/2019 {
  2.         import excel "$MyProject/data/fbi_offenses_known_to_law_enforcement/fbi_offenses_known_to_law_enforcement_`y'.xls", clear
  3.         compress
  4.         save "$MyProject/processed/intermediate/crime_us_`y'_uncleaned.dta", replace
  5. }
(17 vars, 8,784 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2008_uncleaned.dta saved
(13 vars, 9,159 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2009_uncleaned.dta saved
(13 vars, 9,321 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2010_uncleaned.dta saved
(18 vars, 9,325 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2011_uncleaned.dta saved
(15 vars, 9,502 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2012_uncleaned.dta saved
(17 vars, 9,306 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2013_uncleaned.dta saved
(14 vars, 9,368 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2014_uncleaned.dta saved
(14 vars, 9,409 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2015_uncleaned.dta saved
(13 vars, 2,626 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2016_uncleaned.dta saved
(19 vars, 9,593 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2017_uncleaned.dta saved
(13 vars, 9,266 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2018_uncleaned.dta saved
(13 vars, 8,117 obs)
  (0 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/crime_us_2019_uncleaned.dta saved

. 
. // Zip code centroids data
. insheet using "$MyProject/data/ZIP_Code_Population_Weighted_Centroids.csv", comma clear
(10 vars, 35,352 obs)

. compress
  (0 bytes saved)

. save "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", replace
(file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/zip_code_centroids_uncleaned.dta not found)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/zip_code_centroids_uncleaned.dta saved

. 
. ** EOF
. 
end of do-file

. 
. // do "$MyProject/scripts/2a_clean_ma_zoning_data.do"
. // do "$MyProject/scripts/2b_clean_dispensaries_data.do"
. // do "$MyProject/scripts/2c_clean_prop_assessments_data.do"
. // do "$MyProject/scripts/2d_clean_home_values_data.do"
. // do "$MyProject/scripts/2e_clean_boston_crash_data.do"
. // do "$MyProject/scripts/2f_clean_us_crash_data.do"
. // do "$MyProject/scripts/2g_clean_boston_crime_data.do"
. // do "$MyProject/scripts/2h_clean_us_crime_data.do"
. do "$MyProject/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids.dta", clear
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/zip_code_centroids.dta not found
r(601);

end of do-file
r(601);

end of do-file

r(601);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
end of do-file

. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. count if latitude!=lat
  0

. count if longitude!=lgt
  0

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 latitude longitude

. 
. * Save dataset
. compress
  variable std_zip5 was long now int
  (1,152 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
(file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta not found)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. // keep std_zip5 latitude longitude
. 
. * Save dataset
. compress
  variable objectid was long now int
  variable std_zip5 was long now int
  variable usps_zip_pref_city_1221 was str26 now str18
  (6,912 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Save dataset
. compress
  variable std_zip5 was long now int
  variable usps_zip_pref_city_1221 was str26 now str18
  (5,760 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2c_clean_prop_assessments_data.do"

. ************
. * SCRIPT: 2c_clean_prop_assessments_data.do
. * PURPOSE: processes the massachusetts property assessments datasets in preparation for analysis
. ************
. 
. * Clean dataset for each year, one at a time
. forvalues y = 2014/2021 {
  2.         use "$MyProject/processed/intermediate/property_assessments_ma_`y'_uncleaned.dta", clear
  3.         
.         * Rename 2021 variables to have the same name as other years
.         if `y' == 2021 {
  4.                 rename bldg_value av_bldg
  5.                 rename yr_remodel yr_remod
  6.                 rename res_floor num_floors
  7.                 rename bed_rms r_bdrms
  8.                 rename full_bth r_full_bth
  9.                 rename hlf_bth r_half_bth
 10.                 rename kitchen r_kitch
 11.                 rename heat_type r_heat_typ
 12.         }
 13.         
.         * Select only desired columns
.         keep zipcode av_bldg living_area yr_built yr_remod num_floors r_bdrms r_full_bth r_half_bth r_kitch r_heat_typ
 14.         
.         * Create variable for the year the building was assessed
.         gen year_assessed = `y'
 15.         
.         * Change zipcode column to be of uniform format across years
.         if `y' == 2018 | `y' == 2019 | `y' == 2020 | `y' == 2021 {
 16.                 tostring zipcode, replace
 17.                 replace zipcode = "0" + zipcode
 18.         }
 19.         else {
 20.                 replace zipcode = substr(zipcode, 1, 5)
 21.         }
 22.         
.         * Convert dollar amount av_bldg to int (2021 only)
.         if `y' == 2021 {
 23.                 split av_bldg, parse(".00") gen(dollars)
 24.                 destring dollars1, replace ignore("$,")
 25.                 drop av_bldg
 26.                 rename dollars1 av_bldg
 27.         }
 28. 
.         * Drop entries with missing or 0-valued data
.         drop if av_bldg == 0 | missing(av_bldg)
 29.         drop if yr_built == 0 | missing(yr_built)
 30.         drop if num_floors == 0 | missing(num_floors)
 31.         drop if r_bdrms == 0 | missing(r_bdrms)
 32.         
.         * Create variable for years since built
.         gen yrs_since_built = `y' - yr_built
 33.         
.         * Create variable for years since remodel
.         replace yr_remod = 0 if missing(yr_remod)
 34.         replace yr_remod = yr_built if yr_remod==0
 35.         gen yrs_since_remodel = `y' - yr_remod
 36.         drop yr_built yr_remod
 37.         
.         * Replace missing values with 0
.         replace living_area = 0 if missing(living_area)
 38.         replace r_full_bth = 0 if missing(r_full_bth)
 39.         replace r_half_bth = 0 if missing(r_half_bth)
 40.         
.         * Replace string kitchen values with ints
.         if `y' == 2020 {
 41.                 replace r_kitch = "0" if missing(r_kitch)
 42.                 replace r_kitch = substr(r_kitch, 1, 1)
 43.                 replace r_kitch = "0" if real(r_kitch)==. & r_kitch=="N"
 44.                 replace r_kitch = "1" if real(r_kitch)==. & r_kitch!="N"
 45.                 destring r_kitch, replace
 46.         }
 47.         else {
 48.                 replace r_kitch = 0 if missing(r_kitch)
 49.         }
 50.         
.         * Create dummy variables for heat type
.         gen heat_electric = r_heat_typ==`"E"' | r_heat_typ==`"E - Electric"'
 51.         gen heat_forced_hot_air = r_heat_typ==`"F"' | r_heat_typ==`"F - Forced Hot Air"'
 52.         gen heat_pump = r_heat_typ==`"P"' | r_heat_typ==`"P - Heat Pump"'
 53.         gen heat_space = r_heat_typ==`"S"' | r_heat_typ==`"S - Space Heat"'
 54.         gen heat_steam = r_heat_typ==`"W"' | r_heat_typ==`"W - Ht Water/Steam"'
 55.         gen heat_other = r_heat_typ==`"O"' | r_heat_typ==`"O - Other"'
 56.         drop r_heat_typ
 57.         
.         * Save dataset for year `y'
.         compress
 58.         save "$MyProject/processed/intermediate/property_assessments_ma_`y'.dta", replace
 59. }
(164,091 real changes made)
(21,893 observations deleted)
(6,422 observations deleted)
(461 observations deleted)
(72,696 observations deleted)
(0 real changes made)
(43,130 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
  variable living_area was long now int
  variable year_assessed was float now int
  variable yrs_since_built was float now int
  variable yrs_since_remodel was float now int
  variable heat_electric was float now byte
  variable heat_forced_hot_air was float now byte
  variable heat_pump was float now byte
  variable heat_space was float now byte
  variable heat_steam was float now byte
  variable heat_other was float now byte
  variable zipcode was str6 now str5
  (1,690,713 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2014.dta saved
(168,104 real changes made)
(22,311 observations deleted)
(7,645 observations deleted)
(518 observations deleted)
(74,865 observations deleted)
(2,866 real changes made)
(42,378 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
  variable living_area was long now int
  variable year_assessed was float now int
  variable yrs_since_built was float now int
  variable yrs_since_remodel was float now int
  variable heat_electric was float now byte
  variable heat_forced_hot_air was float now byte
  variable heat_pump was float now byte
  variable heat_space was float now byte
  variable heat_steam was float now byte
  variable heat_other was float now byte
  variable zipcode was str6 now str5
  (1,694,952 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2015.dta saved
(169,193 real changes made)
(22,306 observations deleted)
(8,193 observations deleted)
(526 observations deleted)
(75,606 observations deleted)
(2,934 real changes made)
(41,584 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
  variable living_area was long now int
  variable year_assessed was float now int
  variable yrs_since_built was float now int
  variable yrs_since_remodel was float now int
  variable heat_electric was float now byte
  variable heat_forced_hot_air was float now byte
  variable heat_pump was float now byte
  variable heat_space was float now byte
  variable heat_steam was float now byte
  variable heat_other was float now byte
  variable zipcode was str6 now str5
  (1,689,336 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2016.dta saved
(170,903 real changes made)
(22,308 observations deleted)
(9,035 observations deleted)
(561 observations deleted)
(76,542 observations deleted)
(3,030 real changes made)
(40,567 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
  variable living_area was long now int
  variable year_assessed was float now int
  variable yrs_since_built was float now int
  variable yrs_since_remodel was float now int
  variable heat_electric was float now byte
  variable heat_forced_hot_air was float now byte
  variable heat_pump was float now byte
  variable heat_space was float now byte
  variable heat_steam was float now byte
  variable heat_other was float now byte
  variable zipcode was str6 now str5
  (1,686,528 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2017.dta saved
zipcode was int now str4
variable zipcode was str4 now str5
(172,841 real changes made)
(22,307 observations deleted)
(9,719 observations deleted)
(558 observations deleted)
(77,912 observations deleted)
(3,084 real changes made)
(39,493 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
  variable living_area was long now int
  variable year_assessed was float now int
  variable yrs_since_built was float now int
  variable yrs_since_remodel was float now int
  variable heat_electric was float now byte
  variable heat_forced_hot_air was float now byte
  variable heat_pump was float now byte
  variable heat_space was float now byte
  variable heat_steam was float now byte
  variable heat_other was float now byte
  (1,620,970 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2018.dta saved
zipcode was int now str4
variable zipcode was str4 now str5
(174,668 real changes made)
(22,445 observations deleted)
(10,281 observations deleted)
(527 observations deleted)
(79,215 observations deleted)
(3,189 real changes made)
(38,519 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
  variable living_area was long now int
  variable year_assessed was float now int
  variable yrs_since_built was float now int
  variable yrs_since_remodel was float now int
  variable heat_electric was float now byte
  variable heat_forced_hot_air was float now byte
  variable heat_pump was float now byte
  variable heat_space was float now byte
  variable heat_steam was float now byte
  variable heat_other was float now byte
  (1,617,200 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2019.dta saved
zipcode was int now str4
variable zipcode was str4 now str5
(175,052 real changes made)
(17,692 observations deleted)
(15,681 observations deleted)
(335 observations deleted)
(80,015 observations deleted)
(37,082 real changes made)
(37,083 real changes made)
(0 real changes made)
(0 real changes made)
(2 real changes made)
(10 real changes made)
(61,319 real changes made)
(3 real changes made)
(3 real changes made)
r_kitch: all characters numeric; replaced as byte
  variable living_area was long now int
  variable year_assessed was float now int
  variable yrs_since_built was float now int
  variable yrs_since_remodel was float now int
  variable heat_electric was float now byte
  variable heat_forced_hot_air was float now byte
  variable heat_pump was float now byte
  variable heat_space was float now byte
  variable heat_steam was float now byte
  variable heat_other was float now byte
  (1,594,554 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2020.dta saved
zipcode was int now str4
variable zipcode was str4 now str5
(177,091 real changes made)
variable created as string: 
dollars1
dollars1: characters $ , removed; replaced as long
(18079 missing values generated)
(18,079 observations deleted)
(15,325 observations deleted)
(320 observations deleted)
(17,109 observations deleted)
(59,977 real changes made)
(59,977 real changes made)
(6 real changes made)
(6 real changes made)
(92,652 real changes made)
(10 real changes made)
  variable year_assessed was float now int
  variable yrs_since_built was float now int
  variable yrs_since_remodel was float now int
  variable heat_electric was float now byte
  variable heat_forced_hot_air was float now byte
  variable heat_pump was float now byte
  variable heat_space was float now byte
  variable heat_steam was float now byte
  variable heat_other was float now byte
  (3,030,192 bytes saved)
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/intermediate/property_assessments_ma_2021.dta saved

. 
. * Merge datasets from 2014-2021 into one dataset containing all years
. use "$MyProject/processed/intermediate/property_assessments_ma_2014.dta", clear

. forvalues y = 2015/2021 {
  2.         append using "$MyProject/processed/intermediate/property_assessments_ma_`y'.dta"
  3. }
(variable living_area was int, now long to accommodate using data's values)

. 
. * Save dataset containing all years
. compress
  (0 bytes saved)

. save "$MyProject/processed/property_assessments_ma.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/property_assessments_ma.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/4a_regression_dispensaries_on_property_assessments.do"

. ************
. * SCRIPT: 4a_regression_dispensaries_on_property_assessments.do
. * PURPOSE: runs a regression of dispensaries on property assessments
. ************
. 
. * Format property dataset for regression
. use "$MyProject/processed/property_assessments_ma.dta", clear

. 
. // merge using "$MyProject/processed/zip_code_centroids.dta"
. 
. * Format dispensary dataset for regression
. // use "$MyProject/processed/dispensaries.dta", clear
. // keep establishment_zip_code commence_year
. // gen str5 zipcode = string(establishment_zip_code,"%05.0f")
. // drop establishment_zip_code
. // rename commence_year year
. // duplicates drop
. // gen dispensary_t = 1
. //
. //
. // levelsof zipcode, local(zipcodes)
. //
. // forvalues y = 2014/2022 {
. //      foreach z in `zipcodes' {
. //              qui count if year == `y' & zipcode == "`z'"
. //              if r(N) == 0 {
. //                      set obs `=_N + 1'
. //                      replace year = `y' in L
. //                      replace zipcode = "`z'" in L
. //                      replace dispensary_t = 0 in L
. //              }
. //      }
. // }
. // drop if missing(year)
. //
. // forvalues y = 2014/2022 {
. //      foreach z in `zipcodes' {
. //               qui levelsof dispensary_t if year==`y' & zipcode == "`z'", local(d)
. //               if `d'==1 {
. //                      forvalues following_y = `y'/2022 {
. //                              replace dispensary_t = 1 if year==`following_y' & zipcode == "`z'"
. //                      }
. //               }
. //      }
. // }
. //
. // gen dispensary_tp1 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2021 {
. //              qui levelsof dispensary_t if year==`y'+1 & zipcode == "`z'", local(d)
. //              replace dispensary_tp1 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp1 = dispensary_t if year==2022
. // }
. //
. // gen dispensary_tp2 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2020 {
. //              qui levelsof dispensary_t if year==`y'+2 & zipcode == "`z'", local(d)
. //              replace dispensary_tp2 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp2 = dispensary_tp1 if year==2022 | year==2021
. // }
. //
. // gen dispensary_tp3 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2019 {
. //              qui levelsof dispensary_t if year==`y'+3 & zipcode == "`z'", local(d)
. //              replace dispensary_tp3 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp3 = dispensary_tp2 if year==2022 | year==2021 | year==2020
. // }
. //
. // gen dispensary_tm1 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2015/2022 {
. //              qui levelsof dispensary_t if year==`y'-1 & zipcode == "`z'", local(d)
. //              replace dispensary_tm1 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm1 = dispensary_t if year==2014
. // }
. //
. // gen dispensary_tm2 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2016/2022 {
. //              qui levelsof dispensary_t if year==`y'-2 & zipcode == "`z'", local(d)
. //              replace dispensary_tm2 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm2 = dispensary_tm1 if year==2014 | year==2015
. // }
. //
. // gen dispensary_tm3 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2017/2022 {
. //              qui levelsof dispensary_t if year==`y'-3 & zipcode == "`z'", local(d)
. //              replace dispensary_tm3 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm3 = dispensary_tm2 if year==2014 | year==2015 | year==2016
. // }
. //
. // sort zipcode year
. //
. // save "$MyProject/processed/dispensaries_on_property_assessments.dta", replace
. //
. // * Property assessments dataset
. // use "$MyProject/processed/property_assessments_ma.dta", clear
. // // rename year_assessed year
. //
. // // levelsof zipcode, local(zipcodes)
. // // foreach z in `zipcodes'{
. // //   gen i_`z' = zipcode=="`z'"
. // // }
. // //
. // // levelsof year, local(years)
. // // foreach y in `years' {
. // //   gen t_`y' = year==`y'
. // // }
. //
. // * Merge with dispensary dataset
. // merge m:1 zipcode year using "$MyProject/processed/dispensaries_on_property_assessments.dta"
. //
. // drop if _merge==2
. // drop _merge
. //
. // * Run regression
. // local i_vars i_02026 i_02108 i_02109 i_02110 i_02111 i_02113 i_02114 i_02115 i_02116 i_02118 i_02119 i_02120 i_02121 i_02122 i_02124 i_02125 i_02126 i_02127 i_02128 i_02129 i
> _02130 i_02131 i_02132 i_02134 i_02135 i_02136 i_02186 i_02199 i_02210 i_02215 i_02445 i_02446
. //
. // local t_vars t_2015 t_2016 t_2017 t_2018 t_2019 t_2020 t_2021
. //
. // local prop_covar land_sf living_area num_floors r_bdrms r_full_bth r_half_bth r_kitch yrs_since_built yrs_since_remodel heat_electric heat_forced_hot_air heat_pump heat_space
>  heat_steam heat_other
. //
. // regress av_bldg dispensary_t `i_vars' `t_vars' `prop_covar'
. // est store reg_disp
. // ssc install estout, replace
. // estout
. //
. // // outreg2 using results // <- not working
. // // estout 
. //
. // save "$MyProject/processed/dispensaries_on_property_assessments.dta", replace
. 
. * EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/4a_regression_dispensaries_on_property_assessments.do"

. ************
. * SCRIPT: 4a_regression_dispensaries_on_property_assessments.do
. * PURPOSE: runs a regression of dispensaries on property assessments
. ************
. 
. * Format property dataset for regression
. use "$MyProject/processed/property_assessments_ma.dta", clear

. 
. sort zipcode

. merge m:1 zipcode using "$MyProject/processed/zip_code_centroids.dta"
variable zipcode not found
r(111);

end of do-file

r(111);

. use "$MyProject/processed/zip_code_centroids.dta", clear

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Save dataset
. compress
  variable zipcode was long now int
  variable city was str26 now str18
  (5,760 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/4a_regression_dispensaries_on_property_assessments.do"

. ************
. * SCRIPT: 4a_regression_dispensaries_on_property_assessments.do
. * PURPOSE: runs a regression of dispensaries on property assessments
. ************
. 
. * Format property dataset for regression
. use "$MyProject/processed/property_assessments_ma.dta", clear

. 
. sort zipcode

. merge m:1 zipcode using "$MyProject/processed/zip_code_centroids.dta"
key variable zipcode is str5 in master but int in using data
    Each key variable -- the variables on which observations are matched -- must be of the same generic type in the master and using datasets.  Same generic type means both
    numeric or both string.
r(106);

end of do-file

r(106);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Save dataset
. compress
  variable zipcode was long now int
  variable city was str26 now str18
  (5,760 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0`zipcode'"
(576 real changes made)

. 
. * Save dataset
. compress
  variable zipcode was str4 now str1
  variable city was str26 now str18
  (6,336 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + `zipcode'
invalid syntax
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/4a_regression_dispensaries_on_property_assessments.do"

. ************
. * SCRIPT: 4a_regression_dispensaries_on_property_assessments.do
. * PURPOSE: runs a regression of dispensaries on property assessments
. ************
. 
. * Format property dataset for regression
. use "$MyProject/processed/property_assessments_ma.dta", clear

. 
. sort zipcode

. merge m:1 zipcode using "$MyProject/processed/zip_code_centroids.dta"

    Result                      Number of obs
    -----------------------------------------
    Not matched                           543
        from master                         0  (_merge==1)
        from using                        543  (_merge==2)

    Matched                           562,559  (_merge==3)
    -----------------------------------------

. 
. * Format dispensary dataset for regression
. // use "$MyProject/processed/dispensaries.dta", clear
. // keep establishment_zip_code commence_year
. // gen str5 zipcode = string(establishment_zip_code,"%05.0f")
. // drop establishment_zip_code
. // rename commence_year year
. // duplicates drop
. // gen dispensary_t = 1
. //
. //
. // levelsof zipcode, local(zipcodes)
. //
. // forvalues y = 2014/2022 {
. //      foreach z in `zipcodes' {
. //              qui count if year == `y' & zipcode == "`z'"
. //              if r(N) == 0 {
. //                      set obs `=_N + 1'
. //                      replace year = `y' in L
. //                      replace zipcode = "`z'" in L
. //                      replace dispensary_t = 0 in L
. //              }
. //      }
. // }
. // drop if missing(year)
. //
. // forvalues y = 2014/2022 {
. //      foreach z in `zipcodes' {
. //               qui levelsof dispensary_t if year==`y' & zipcode == "`z'", local(d)
. //               if `d'==1 {
. //                      forvalues following_y = `y'/2022 {
. //                              replace dispensary_t = 1 if year==`following_y' & zipcode == "`z'"
. //                      }
. //               }
. //      }
. // }
. //
. // gen dispensary_tp1 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2021 {
. //              qui levelsof dispensary_t if year==`y'+1 & zipcode == "`z'", local(d)
. //              replace dispensary_tp1 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp1 = dispensary_t if year==2022
. // }
. //
. // gen dispensary_tp2 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2020 {
. //              qui levelsof dispensary_t if year==`y'+2 & zipcode == "`z'", local(d)
. //              replace dispensary_tp2 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp2 = dispensary_tp1 if year==2022 | year==2021
. // }
. //
. // gen dispensary_tp3 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2019 {
. //              qui levelsof dispensary_t if year==`y'+3 & zipcode == "`z'", local(d)
. //              replace dispensary_tp3 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp3 = dispensary_tp2 if year==2022 | year==2021 | year==2020
. // }
. //
. // gen dispensary_tm1 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2015/2022 {
. //              qui levelsof dispensary_t if year==`y'-1 & zipcode == "`z'", local(d)
. //              replace dispensary_tm1 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm1 = dispensary_t if year==2014
. // }
. //
. // gen dispensary_tm2 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2016/2022 {
. //              qui levelsof dispensary_t if year==`y'-2 & zipcode == "`z'", local(d)
. //              replace dispensary_tm2 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm2 = dispensary_tm1 if year==2014 | year==2015
. // }
. //
. // gen dispensary_tm3 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2017/2022 {
. //              qui levelsof dispensary_t if year==`y'-3 & zipcode == "`z'", local(d)
. //              replace dispensary_tm3 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm3 = dispensary_tm2 if year==2014 | year==2015 | year==2016
. // }
. //
. // sort zipcode year
. //
. // save "$MyProject/processed/dispensaries_on_property_assessments.dta", replace
. //
. // * Property assessments dataset
. // use "$MyProject/processed/property_assessments_ma.dta", clear
. // // rename year_assessed year
. //
. // // levelsof zipcode, local(zipcodes)
. // // foreach z in `zipcodes'{
. // //   gen i_`z' = zipcode=="`z'"
. // // }
. // //
. // // levelsof year, local(years)
. // // foreach y in `years' {
. // //   gen t_`y' = year==`y'
. // // }
. //
. // * Merge with dispensary dataset
. // merge m:1 zipcode year using "$MyProject/processed/dispensaries_on_property_assessments.dta"
. //
. // drop if _merge==2
. // drop _merge
. //
. // * Run regression
. // local i_vars i_02026 i_02108 i_02109 i_02110 i_02111 i_02113 i_02114 i_02115 i_02116 i_02118 i_02119 i_02120 i_02121 i_02122 i_02124 i_02125 i_02126 i_02127 i_02128 i_02129 i
> _02130 i_02131 i_02132 i_02134 i_02135 i_02136 i_02186 i_02199 i_02210 i_02215 i_02445 i_02446
. //
. // local t_vars t_2015 t_2016 t_2017 t_2018 t_2019 t_2020 t_2021
. //
. // local prop_covar land_sf living_area num_floors r_bdrms r_full_bth r_half_bth r_kitch yrs_since_built yrs_since_remodel heat_electric heat_forced_hot_air heat_pump heat_space
>  heat_steam heat_other
. //
. // regress av_bldg dispensary_t `i_vars' `t_vars' `prop_covar'
. // est store reg_disp
. // ssc install estout, replace
. // estout
. //
. // // outreg2 using results // <- not working
. // // estout 
. //
. // save "$MyProject/processed/dispensaries_on_property_assessments.dta", replace
. 
. * EOF
. 
end of do-file

. levelsof _merge
2 3

. levelsof zipcode if _merge==2
`"01001"' `"01002"' `"01003"' `"01004"' `"01005"' `"01007"' `"01008"' `"01010"' `"01011"' `"01012"' `"01013"' `"01014"' `"01020"' `"01021"' `"01022"' `"01026"' `"01027"' `"01028"'
>  `"01030"' `"01031"' `"01032"' `"01033"' `"01034"' `"01035"' `"01036"' `"01038"' `"01039"' `"01040"' `"01041"' `"01050"' `"01053"' `"01054"' `"01056"' `"01057"' `"01060"' `"0106
> 1"' `"01062"' `"01068"' `"01069"' `"01070"' `"01071"' `"01072"' `"01073"' `"01075"' `"01077"' `"01080"' `"01081"' `"01082"' `"01084"' `"01085"' `"01088"' `"01089"' `"01090"' `"0
> 1095"' `"01096"' `"01098"' `"01101"' `"01103"' `"01104"' `"01105"' `"01106"' `"01107"' `"01108"' `"01109"' `"01116"' `"01118"' `"01119"' `"01128"' `"01129"' `"01138"' `"01139"' 
> `"01151"' `"01201"' `"01202"' `"01220"' `"01222"' `"01223"' `"01224"' `"01225"' `"01226"' `"01227"' `"01230"' `"01235"' `"01236"' `"01237"' `"01238"' `"01240"' `"01245"' `"01247
> "' `"01253"' `"01254"' `"01255"' `"01256"' `"01257"' `"01258"' `"01259"' `"01266"' `"01267"' `"01270"' `"01301"' `"01302"' `"01330"' `"01331"' `"01337"' `"01338"' `"01339"' `"01
> 340"' `"01341"' `"01342"' `"01343"' `"01344"' `"01346"' `"01349"' `"01350"' `"01351"' `"01354"' `"01355"' `"01360"' `"01364"' `"01366"' `"01367"' `"01368"' `"01370"' `"01373"' `
> "01375"' `"01376"' `"01378"' `"01379"' `"01380"' `"01420"' `"01430"' `"01431"' `"01432"' `"01434"' `"01436"' `"01438"' `"01440"' `"01450"' `"01451"' `"01452"' `"01453"' `"01460"
> ' `"01462"' `"01463"' `"01464"' `"01468"' `"01469"' `"01473"' `"01474"' `"01475"' `"01501"' `"01503"' `"01504"' `"01505"' `"01506"' `"01507"' `"01508"' `"01509"' `"01510"' `"015
> 15"' `"01516"' `"01518"' `"01519"' `"01520"' `"01521"' `"01522"' `"01523"' `"01524"' `"01525"' `"01527"' `"01529"' `"01531"' `"01532"' `"01534"' `"01535"' `"01536"' `"01537"' `"
> 01538"' `"01540"' `"01541"' `"01542"' `"01543"' `"01545"' `"01550"' `"01560"' `"01562"' `"01564"' `"01566"' `"01568"' `"01569"' `"01570"' `"01571"' `"01581"' `"01583"' `"01585"'
>  `"01586"' `"01588"' `"01590"' `"01601"' `"01602"' `"01603"' `"01604"' `"01605"' `"01606"' `"01607"' `"01608"' `"01609"' `"01610"' `"01611"' `"01612"' `"01613"' `"01701"' `"0170
> 2"' `"01703"' `"01704"' `"01718"' `"01719"' `"01720"' `"01721"' `"01730"' `"01731"' `"01740"' `"01741"' `"01742"' `"01745"' `"01746"' `"01747"' `"01748"' `"01749"' `"01752"' `"0
> 1754"' `"01756"' `"01757"' `"01760"' `"01770"' `"01772"' `"01773"' `"01775"' `"01776"' `"01778"' `"01801"' `"01803"' `"01810"' `"01821"' `"01822"' `"01824"' `"01826"' `"01827"' 
> `"01830"' `"01831"' `"01832"' `"01833"' `"01834"' `"01835"' `"01840"' `"01841"' `"01842"' `"01843"' `"01844"' `"01845"' `"01850"' `"01851"' `"01852"' `"01853"' `"01854"' `"01860
> "' `"01862"' `"01863"' `"01864"' `"01865"' `"01867"' `"01876"' `"01879"' `"01880"' `"01886"' `"01887"' `"01888"' `"01890"' `"01901"' `"01902"' `"01903"' `"01904"' `"01905"' `"01
> 906"' `"01907"' `"01908"' `"01913"' `"01915"' `"01921"' `"01922"' `"01923"' `"01929"' `"01930"' `"01931"' `"01936"' `"01938"' `"01940"' `"01944"' `"01945"' `"01949"' `"01950"' `
> "01951"' `"01952"' `"01960"' `"01961"' `"01965"' `"01966"' `"01969"' `"01970"' `"01971"' `"01982"' `"01983"' `"01984"' `"01985"' `"02018"' `"02019"' `"02020"' `"02021"' `"02025"
> ' `"02027"' `"02030"' `"02032"' `"02035"' `"02038"' `"02041"' `"02043"' `"02045"' `"02047"' `"02048"' `"02050"' `"02051"' `"02052"' `"02053"' `"02054"' `"02056"' `"02060"' `"020
> 61"' `"02062"' `"02065"' `"02066"' `"02067"' `"02071"' `"02072"' `"02081"' `"02090"' `"02093"' `"02112"' `"02117"' `"02123"' `"02137"' `"02138"' `"02139"' `"02140"' `"02141"' `"
> 02142"' `"02143"' `"02144"' `"02145"' `"02148"' `"02149"' `"02150"' `"02151"' `"02152"' `"02155"' `"02163"' `"02169"' `"02170"' `"02171"' `"02176"' `"02180"' `"02184"' `"02185"'
>  `"02188"' `"02189"' `"02190"' `"02191"' `"02196"' `"02203"' `"02205"' `"02238"' `"02269"' `"02301"' `"02302"' `"02303"' `"02304"' `"02305"' `"02322"' `"02324"' `"02327"' `"0233
> 0"' `"02331"' `"02332"' `"02333"' `"02334"' `"02338"' `"02339"' `"02341"' `"02343"' `"02345"' `"02346"' `"02347"' `"02350"' `"02351"' `"02356"' `"02359"' `"02360"' `"02361"' `"0
> 2362"' `"02364"' `"02367"' `"02368"' `"02370"' `"02375"' `"02379"' `"02382"' `"02420"' `"02421"' `"02447"' `"02451"' `"02452"' `"02453"' `"02454"' `"02455"' `"02458"' `"02459"' 
> `"02460"' `"02461"' `"02462"' `"02464"' `"02465"' `"02466"' `"02468"' `"02471"' `"02472"' `"02474"' `"02476"' `"02478"' `"02481"' `"02482"' `"02492"' `"02493"' `"02494"' `"02532
> "' `"02534"' `"02535"' `"02536"' `"02537"' `"02538"' `"02539"' `"02540"' `"02541"' `"02542"' `"02543"' `"02554"' `"02556"' `"02557"' `"02558"' `"02559"' `"02561"' `"02562"' `"02
> 563"' `"02568"' `"02571"' `"02574"' `"02575"' `"02576"' `"02584"' `"02601"' `"02630"' `"02631"' `"02632"' `"02633"' `"02634"' `"02635"' `"02637"' `"02638"' `"02639"' `"02641"' `
> "02642"' `"02644"' `"02645"' `"02646"' `"02647"' `"02648"' `"02649"' `"02650"' `"02652"' `"02653"' `"02655"' `"02657"' `"02659"' `"02660"' `"02661"' `"02662"' `"02664"' `"02666"
> ' `"02667"' `"02668"' `"02669"' `"02670"' `"02671"' `"02672"' `"02673"' `"02675"' `"02702"' `"02703"' `"02712"' `"02715"' `"02717"' `"02718"' `"02719"' `"02720"' `"02721"' `"027
> 22"' `"02723"' `"02724"' `"02725"' `"02726"' `"02738"' `"02739"' `"02740"' `"02741"' `"02742"' `"02743"' `"02744"' `"02745"' `"02746"' `"02747"' `"02748"' `"02760"' `"02761"' `"
> 02762"' `"02763"' `"02764"' `"02766"' `"02767"' `"02769"' `"02770"' `"02771"' `"02777"' `"02779"' `"02780"' `"02790"'

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/4a_regression_dispensaries_on_property_assessments.do"

. ************
. * SCRIPT: 4a_regression_dispensaries_on_property_assessments.do
. * PURPOSE: runs a regression of dispensaries on property assessments
. ************
. 
. * Format property dataset for regression
. use "$MyProject/processed/property_assessments_ma.dta", clear

. 
. sort zipcode

. merge m:1 zipcode using "$MyProject/processed/zip_code_centroids.dta"

    Result                      Number of obs
    -----------------------------------------
    Not matched                           543
        from master                         0  (_merge==1)
        from using                        543  (_merge==2)

    Matched                           562,559  (_merge==3)
    -----------------------------------------

. keep if _merge==3
(543 observations deleted)

. drop _merge

. 
. * Format dispensary dataset for regression
. // use "$MyProject/processed/dispensaries.dta", clear
. // keep establishment_zip_code commence_year
. // gen str5 zipcode = string(establishment_zip_code,"%05.0f")
. // drop establishment_zip_code
. // rename commence_year year
. // duplicates drop
. // gen dispensary_t = 1
. //
. //
. // levelsof zipcode, local(zipcodes)
. //
. // forvalues y = 2014/2022 {
. //      foreach z in `zipcodes' {
. //              qui count if year == `y' & zipcode == "`z'"
. //              if r(N) == 0 {
. //                      set obs `=_N + 1'
. //                      replace year = `y' in L
. //                      replace zipcode = "`z'" in L
. //                      replace dispensary_t = 0 in L
. //              }
. //      }
. // }
. // drop if missing(year)
. //
. // forvalues y = 2014/2022 {
. //      foreach z in `zipcodes' {
. //               qui levelsof dispensary_t if year==`y' & zipcode == "`z'", local(d)
. //               if `d'==1 {
. //                      forvalues following_y = `y'/2022 {
. //                              replace dispensary_t = 1 if year==`following_y' & zipcode == "`z'"
. //                      }
. //               }
. //      }
. // }
. //
. // gen dispensary_tp1 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2021 {
. //              qui levelsof dispensary_t if year==`y'+1 & zipcode == "`z'", local(d)
. //              replace dispensary_tp1 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp1 = dispensary_t if year==2022
. // }
. //
. // gen dispensary_tp2 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2020 {
. //              qui levelsof dispensary_t if year==`y'+2 & zipcode == "`z'", local(d)
. //              replace dispensary_tp2 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp2 = dispensary_tp1 if year==2022 | year==2021
. // }
. //
. // gen dispensary_tp3 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2014/2019 {
. //              qui levelsof dispensary_t if year==`y'+3 & zipcode == "`z'", local(d)
. //              replace dispensary_tp3 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tp3 = dispensary_tp2 if year==2022 | year==2021 | year==2020
. // }
. //
. // gen dispensary_tm1 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2015/2022 {
. //              qui levelsof dispensary_t if year==`y'-1 & zipcode == "`z'", local(d)
. //              replace dispensary_tm1 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm1 = dispensary_t if year==2014
. // }
. //
. // gen dispensary_tm2 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2016/2022 {
. //              qui levelsof dispensary_t if year==`y'-2 & zipcode == "`z'", local(d)
. //              replace dispensary_tm2 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm2 = dispensary_tm1 if year==2014 | year==2015
. // }
. //
. // gen dispensary_tm3 = 0
. // foreach z in `zipcodes' {
. //      forvalues y = 2017/2022 {
. //              qui levelsof dispensary_t if year==`y'-3 & zipcode == "`z'", local(d)
. //              replace dispensary_tm3 = `d' if year==`y' & zipcode == "`z'"
. //      }
. //      replace dispensary_tm3 = dispensary_tm2 if year==2014 | year==2015 | year==2016
. // }
. //
. // sort zipcode year
. //
. // save "$MyProject/processed/dispensaries_on_property_assessments.dta", replace
. //
. // * Property assessments dataset
. // use "$MyProject/processed/property_assessments_ma.dta", clear
. // // rename year_assessed year
. //
. // // levelsof zipcode, local(zipcodes)
. // // foreach z in `zipcodes'{
. // //   gen i_`z' = zipcode=="`z'"
. // // }
. // //
. // // levelsof year, local(years)
. // // foreach y in `years' {
. // //   gen t_`y' = year==`y'
. // // }
. //
. // * Merge with dispensary dataset
. // merge m:1 zipcode year using "$MyProject/processed/dispensaries_on_property_assessments.dta"
. //
. // drop if _merge==2
. // drop _merge
. //
. // * Run regression
. // local i_vars i_02026 i_02108 i_02109 i_02110 i_02111 i_02113 i_02114 i_02115 i_02116 i_02118 i_02119 i_02120 i_02121 i_02122 i_02124 i_02125 i_02126 i_02127 i_02128 i_02129 i
> _02130 i_02131 i_02132 i_02134 i_02135 i_02136 i_02186 i_02199 i_02210 i_02215 i_02445 i_02446
. //
. // local t_vars t_2015 t_2016 t_2017 t_2018 t_2019 t_2020 t_2021
. //
. // local prop_covar land_sf living_area num_floors r_bdrms r_full_bth r_half_bth r_kitch yrs_since_built yrs_since_remodel heat_electric heat_forced_hot_air heat_pump heat_space
>  heat_steam heat_other
. //
. // regress av_bldg dispensary_t `i_vars' `t_vars' `prop_covar'
. // est store reg_disp
. // ssc install estout, replace
. // estout
. //
. // // outreg2 using results // <- not working
. // // estout 
. //
. // save "$MyProject/processed/dispensaries_on_property_assessments.dta", replace
. 
. * EOF
. 
end of do-file

. help post

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. ** EOF
. 
end of do-file

. do "/var/folders/f8/b0yvw63s7q32wx1k476bz7t00000gn/T//SD04554.000000"

. format establishment_zip_code %05.0f
variable establishment_zip_code not found
r(111);

end of do-file

r(111);

. do "/var/folders/f8/b0yvw63s7q32wx1k476bz7t00000gn/T//SD04554.000000"

. format establishment_zip_code %05.0f
variable establishment_zip_code not found
r(111);

end of do-file

r(111);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2b_clean_dispensaries_data.do"

. ************
. * SCRIPT: 2b_clean_dispensaries_data.do
. * PURPOSE: processes the dispensaries dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/dispensaries_uncleaned.dta", clear

. 
. * Select only desired columns
. keep business_name dba_name license_type establishment_address_1 establishment_city establishment_zip_code establishment_county commence_operations_date latitude longitude

. 
. * Keep only entries that have certain license types
. keep if license_type=="Marijuana Retailer"
(520 observations deleted)

. drop license_type

. 
. * Keep only entries that have commenced operations
. keep if commence_operations_date!=""
(162 observations deleted)

. 
. * Create variables for commencement operations month, day, and year
. split commence_operations_date, parse("/")
variables created as string: 
commence_o~1  commence_o~2  commence_o~3

. destring commence_operations_date1, gen(commence_month)
commence_operations_date1: all characters numeric; commence_month generated as byte

. destring commence_operations_date2, gen(commence_day)
commence_operations_date2: all characters numeric; commence_day generated as byte

. destring commence_operations_date3, gen(commence_year)
commence_operations_date3: all characters numeric; commence_year generated as int

. drop commence_operations_date commence_operations_date1 commence_operations_date2 commence_operations_date3

. 
. * Change format of zip code to be 5 digits
. format establishment_zip_code %05.0f

. 
. * Rename address variable
. rename establishment_address_1 establishment_address

. 
. * Manually update lat/lon coordinates of HVV Massachusetts, Inc.
. replace lat = 42.387990 if establishment_address=="220 William McClellan Hwy"
(1 real change made)

. replace lon = -71.017820 if establishment_address=="220 William McClellan Hwy"
(1 real change made)

. 
. * Save dataset
. compress
  variable business_name was str60 now str58
  variable dba_name was str64 now str32
  variable establishment_address was str54 now str51
  variable establishment_city was str18 now str16
  (7,995 bytes saved)

. save "$MyProject/processed/dispensaries.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/dispensaries.dta saved

. outsheet using "$MyProject/processed/dispensaries.csv", comma replace

. 
. * Create dataset with only dispensaries in the Boston area
. keep if establishment_city=="Boston" | establishment_city=="Brookline"
(194 observations deleted)

. compress
  variable business_name was str58 now str34
  variable dba_name was str32 now str14
  variable establishment_address was str51 now str25
  variable establishment_city was str16 now str9
  variable establishment_county was str10 now str7
  (858 bytes saved)

. save "$MyProject/processed/dispensaries_boston.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/dispensaries_boston.dta saved

. outsheet using "$MyProject/processed/dispensaries_boston.csv", comma replace

. 
. ** EOF
. 
end of do-file

. gen lat_lon = latitude + "_" + longitude
type mismatch
r(109);

. gen lat_lon = `latitude' + "_" + `longitude
+"_" invalid name
r(198);

. gen lat_lon = "`latitude'_`longitude'"

. drop lat_lon

. gen lat_lon = `latitude'_`longitude'
_ not found
r(111);

. gen lat_lon = `latitude'"_"`longitude'

. egen lat_lon = concat(latitude, longitude), punct("_")
variable lat_lon already defined
r(110);

. drop lat_lon

. egen lat_lon = concat(latitude, longitude), punct("_")
invalid syntax
r(198);

. egen lat_lon = concat(latitude longitude), punct("_")

. drop lat_lon

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/property_assessments_ma.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")
variable latitude not found
r(111);

end of do-file

r(111);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. 
. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2b_clean_dispensaries_data.do"

. ************
. * SCRIPT: 2b_clean_dispensaries_data.do
. * PURPOSE: processes the dispensaries dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/dispensaries_uncleaned.dta", clear

. 
. * Select only desired columns
. keep business_name dba_name license_type establishment_address_1 establishment_city establishment_zip_code establishment_county commence_operations_date latitude longitude

. 
. * Keep only entries that have certain license types
. keep if license_type=="Marijuana Retailer"
(520 observations deleted)

. drop license_type

. 
. * Keep only entries that have commenced operations
. keep if commence_operations_date!=""
(162 observations deleted)

. 
. * Create variables for commencement operations month, day, and year
. split commence_operations_date, parse("/")
variables created as string: 
commence_o~1  commence_o~2  commence_o~3

. destring commence_operations_date1, gen(commence_month)
commence_operations_date1: all characters numeric; commence_month generated as byte

. destring commence_operations_date2, gen(commence_day)
commence_operations_date2: all characters numeric; commence_day generated as byte

. destring commence_operations_date3, gen(commence_year)
commence_operations_date3: all characters numeric; commence_year generated as int

. drop commence_operations_date commence_operations_date1 commence_operations_date2 commence_operations_date3

. 
. * Change format of zip code to be 5 digits
. format establishment_zip_code %05.0f

. 
. * Rename address variable
. rename establishment_address_1 establishment_address

. 
. * Manually update lat/lon coordinates of HVV Massachusetts, Inc.
. replace lat = 42.387990 if establishment_address=="220 William McClellan Hwy"
(1 real change made)

. replace lon = -71.017820 if establishment_address=="220 William McClellan Hwy"
(1 real change made)

. 
. * Save dataset
. compress
  variable business_name was str60 now str58
  variable dba_name was str64 now str32
  variable establishment_address was str54 now str51
  variable establishment_city was str18 now str16
  (7,995 bytes saved)

. save "$MyProject/processed/dispensaries.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/dispensaries.dta saved

. outsheet using "$MyProject/processed/dispensaries.csv", comma replace

. 
. * Create dataset with only dispensaries in the Boston area
. keep if establishment_city=="Boston" | establishment_city=="Brookline"
(194 observations deleted)

. compress
  variable business_name was str58 now str34
  variable dba_name was str32 now str14
  variable establishment_address was str51 now str25
  variable establishment_city was str16 now str9
  variable establishment_county was str10 now str7
  (858 bytes saved)

. save "$MyProject/processed/dispensaries_boston.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/dispensaries_boston.dta saved

. outsheet using "$MyProject/processed/dispensaries_boston.csv", comma replace

. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. 
. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. levelsof lat_lon, local(locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. foreach disp_loc of `disp_locs' {
  2.         di `disp_loc'
  3. }
invalid syntax
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. foreach disp_loc of local `disp_locs' {
  2.         di `disp_loc'
  3. }
_"42.30654 -71.05796 invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. foreach disp_loc of local `disp_locs' {
  2.         di "`disp_loc'"
  3. }
_"42.30654 -71.05796 invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. foreach disp_loc of local `disp_locs' {
  2.         di `disp_loc'
  3. }
_"42.30654 -71.05796 invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach loc of local `disp_locs' {
  2.         di `loc'
  3. }
_"42.30654 -71.05796 invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach loc of local `disp_locs' {
  2.         di "`loc'"
  3. }
_"42.30654 -71.05796 invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach loc of local `disp_locs' {
  2.         di "loc of `loc'"
  3. }
_"42.30654 -71.05796 invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local `disp_locs' {
  2.         di "loc of `disp_loc'"
  3. }
_"42.30654 -71.05796 invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local disp_locs {
  2.         di "loc of `disp_loc'"
  3. }
loc of 42.30654 -71.05796
loc of 42.30969 -71.0822
loc of 42.32167 -71.11039
loc of 42.33174 -71.11803
loc of 42.34157 -71.12223
loc of 42.34559 -71.09985
loc of 42.35149 -71.12183
loc of 42.35665 -71.05827
loc of 42.36466 -71.06143
loc of 42.3761 -71.03889
loc of 42.38799 -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local disp_locs {
  2.         di "`disp_loc'"
  3. }
42.30654 -71.05796
42.30969 -71.0822
42.32167 -71.11039
42.33174 -71.11803
42.34157 -71.12223
42.34559 -71.09985
42.35149 -71.12183
42.35665 -71.05827
42.36466 -71.06143
42.3761 -71.03889
42.38799 -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local disp_locs {
  2.         local pos = strpos("`disp_loc'", " ") + 1
  3.         local lat = substr("`disp_loc'", ., `pos')
  4.     local lon = substr("`disp_loc'", `pos', .)
  5. }

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local disp_locs {
  2.         local pos = strpos("`disp_loc'", " ") + 1
  3.         local lat = substr("`disp_loc'", ., `pos')
  4.     local lon = substr("`disp_loc'", `pos', .)
  5.         di "`lat'"
  6.         di "`lon'"
  7. }

-71.05796

-71.0822

-71.11039

-71.11803

-71.12223

-71.09985

-71.12183

-71.05827

-71.06143

-71.03889

-71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local disp_locs {
  2.         local pos = strpos("`disp_loc'", " ") + 1
  3.         local lat = substr("`disp_loc'", 0, `pos')
  4.     local lon = substr("`disp_loc'", `pos', .)
  5.         di "`lat'"
  6.         di "`lon'"
  7. }

-71.05796

-71.0822

-71.11039

-71.11803

-71.12223

-71.09985

-71.12183

-71.05827

-71.06143

-71.03889

-71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local disp_locs {
  2.         local pos = strpos("`disp_loc'", " ") + 1
  3.         local lat = substr("`disp_loc'", 0, `pos')
  4.     local lon = substr("`disp_loc'", `pos', .)
  5.         di "`pos'"
  6.         di "`lat'"
  7.         di "`lon'"
  8. }
10

-71.05796
10

-71.0822
10

-71.11039
10

-71.11803
10

-71.12223
10

-71.09985
10

-71.12183
10

-71.05827
10

-71.06143
9

-71.03889
10

-71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local disp_locs {
  2.         local pos = strpos("`disp_loc'", " ") + 1
  3.         local lat = substr("`disp_loc'", 1, `pos')
  4.     local lon = substr("`disp_loc'", `pos', .)
  5.         di "`pos'"
  6.         di "`lat'"
  7.         di "`lon'"
  8. }
10
42.30654 -
-71.05796
10
42.30969 -
-71.0822
10
42.32167 -
-71.11039
10
42.33174 -
-71.11803
10
42.34157 -
-71.12223
10
42.34559 -
-71.09985
10
42.35149 -
-71.12183
10
42.35665 -
-71.05827
10
42.36466 -
-71.06143
9
42.3761 -
-71.03889
10
42.38799 -
-71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. foreach disp_loc of local disp_locs {
  2.         local pos = strpos("`disp_loc'", " ") + 1
  3.         local lat = substr("`disp_loc'", 1, `pos'-1)
  4.     local lon = substr("`disp_loc'", `pos', .)
  5.         di "`pos'"
  6.         di "`lat'"
  7.         di "`lon'"
  8. }
10
42.30654 
-71.05796
10
42.30969 
-71.0822
10
42.32167 
-71.11039
10
42.33174 
-71.11803
10
42.34157 
-71.12223
10
42.34559 
-71.09985
10
42.35149 
-71.12183
10
42.35665 
-71.05827
10
42.36466 
-71.06143
9
42.3761 
-71.03889
10
42.38799 
-71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos'-1)
  6.     local lon = substr("`disp_loc'", `pos', .)
  7.         
. }
1
2
3
4
5
6
7
8
9
10
11

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos'-1)
  6.     local lon = substr("`disp_loc'", `pos', .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654  -71.05796
2
10 42.30969  -71.0822
3
10 42.32167  -71.11039
4
10 42.33174  -71.11803
5
10 42.34157  -71.12223
6
10 42.34559  -71.09985
7
10 42.35149  -71.12183
8
10 42.35665  -71.05827
9
10 42.36466  -71.06143
10
9 42.3761  -71.03889
11
10 42.38799  -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 1)
  6.     local lon = substr("`disp_loc'", `pos' + 1, .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654  71.05796
2
10 42.30969  71.0822
3
10 42.32167  71.11039
4
10 42.33174  71.11803
5
10 42.34157  71.12223
6
10 42.34559  71.09985
7
10 42.35149  71.12183
8
10 42.35665  71.05827
9
10 42.36466  71.06143
10
9 42.3761  71.03889
11
10 42.38799  71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos')
  6.     local lon = substr("`disp_loc'", `pos' + 1, .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654 - 71.05796
2
10 42.30969 - 71.0822
3
10 42.32167 - 71.11039
4
10 42.33174 - 71.11803
5
10 42.34157 - 71.12223
6
10 42.34559 - 71.09985
7
10 42.35149 - 71.12183
8
10 42.35665 - 71.05827
9
10 42.36466 - 71.06143
10
9 42.3761 - 71.03889
11
10 42.38799 - 71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 1)
  6.     local lon = substr("`disp_loc'", `pos' + 1, .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654  71.05796
2
10 42.30969  71.0822
3
10 42.32167  71.11039
4
10 42.33174  71.11803
5
10 42.34157  71.12223
6
10 42.34559  71.09985
7
10 42.35149  71.12183
8
10 42.35665  71.05827
9
10 42.36466  71.06143
10
9 42.3761  71.03889
11
10 42.38799  71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 1)
  6.     local lon = substr("`disp_loc'", `pos', .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654  -71.05796
2
10 42.30969  -71.0822
3
10 42.32167  -71.11039
4
10 42.33174  -71.11803
5
10 42.34157  -71.12223
6
10 42.34559  -71.09985
7
10 42.35149  -71.12183
8
10 42.35665  -71.05827
9
10 42.36466  -71.06143
10
9 42.3761  -71.03889
11
10 42.38799  -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 1)
  6.     local lon = substr("`disp_loc'", `pos' - 1, .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654   -71.05796
2
10 42.30969   -71.0822
3
10 42.32167   -71.11039
4
10 42.33174   -71.11803
5
10 42.34157   -71.12223
6
10 42.34559   -71.09985
7
10 42.35149   -71.12183
8
10 42.35665   -71.05827
9
10 42.36466   -71.06143
10
9 42.3761   -71.03889
11
10 42.38799   -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 1)
  6.     local lon = substr("`disp_loc'", `pos' + 2, .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654  1.05796
2
10 42.30969  1.0822
3
10 42.32167  1.11039
4
10 42.33174  1.11803
5
10 42.34157  1.12223
6
10 42.34559  1.09985
7
10 42.35149  1.12183
8
10 42.35665  1.05827
9
10 42.36466  1.06143
10
9 42.3761  1.03889
11
10 42.38799  1.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 1)
  6.     local lon = substr("`disp_loc'", `pos' + 1, .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654  71.05796
2
10 42.30969  71.0822
3
10 42.32167  71.11039
4
10 42.33174  71.11803
5
10 42.34157  71.12223
6
10 42.34559  71.09985
7
10 42.35149  71.12183
8
10 42.35665  71.05827
9
10 42.36466  71.06143
10
9 42.3761  71.03889
11
10 42.38799  71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 1)
  6.     local lon = substr("`disp_loc'", `pos', .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654  -71.05796
2
10 42.30969  -71.0822
3
10 42.32167  -71.11039
4
10 42.33174  -71.11803
5
10 42.34157  -71.12223
6
10 42.34559  -71.09985
7
10 42.35149  -71.12183
8
10 42.35665  -71.05827
9
10 42.36466  -71.06143
10
9 42.3761  -71.03889
11
10 42.38799  -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos')
  6.     local lon = substr("`disp_loc'", `pos', .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654 - -71.05796
2
10 42.30969 - -71.0822
3
10 42.32167 - -71.11039
4
10 42.33174 - -71.11803
5
10 42.34157 - -71.12223
6
10 42.34559 - -71.09985
7
10 42.35149 - -71.12183
8
10 42.35665 - -71.05827
9
10 42.36466 - -71.06143
10
9 42.3761 - -71.03889
11
10 42.38799 - -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 1)
  6.     local lon = substr("`disp_loc'", `pos', .)
  7.         di "`pos'`lat'`lon'"
  8.         
. }
1
1042.30654 -71.05796
2
1042.30969 -71.0822
3
1042.32167 -71.11039
4
1042.33174 -71.11803
5
1042.34157 -71.12223
6
1042.34559 -71.09985
7
1042.35149 -71.12183
8
1042.35665 -71.05827
9
1042.36466 -71.06143
10
942.3761 -71.03889
11
1042.38799 -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 2)
  6.     local lon = substr("`disp_loc'", `pos', .)
  7.         di "`pos'`lat'`lon'"
  8.         
. }
1
1042.30654-71.05796
2
1042.30969-71.0822
3
1042.32167-71.11039
4
1042.33174-71.11803
5
1042.34157-71.12223
6
1042.34559-71.09985
7
1042.35149-71.12183
8
1042.35665-71.05827
9
1042.36466-71.06143
10
942.3761-71.03889
11
1042.38799-71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/dispensaries_boston.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         di "`i'"
  4.         local pos = strpos("`disp_loc'", " ") + 1
  5.         local lat = substr("`disp_loc'", 1, `pos' - 2)
  6.     local lon = substr("`disp_loc'", `pos', .)
  7.         di "`pos' `lat' `lon'"
  8.         
. }
1
10 42.30654 -71.05796
2
10 42.30969 -71.0822
3
10 42.32167 -71.11039
4
10 42.33174 -71.11803
5
10 42.34157 -71.12223
6
10 42.34559 -71.09985
7
10 42.35149 -71.12183
8
10 42.35665 -71.05827
9
10 42.36466 -71.06143
10
9 42.3761 -71.03889
11
10 42.38799 -71.01782

. * Update dataset
. // compress
. // save "$MyProject/processed/zip_code_centroids.dta", replace
. 
. ** EOF
. 
end of do-file

. di _pi
3.1415927

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         local temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     local temp_lon = substr("`disp_loc'", `pos', .)
  6.         gen temp_delta_phi = (temp_lat - ) * _pi/180;
  7.         gen temp_delta_rho = (temp_lon - )
  8. }
temp_lat- invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         local temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     local temp_lon = substr("`disp_loc'", `pos', .)
  6.         gen temp_delta_phi = (temp_lat - latitude) * _pi/180;
  7.         gen temp_delta_rho = (temp_lon - longitude)
  8. }
temp_lat not found
r(111);

end of do-file

r(111);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         gen temp_delta_phi = (temp_lat - latitude) * _pi/180;
  7.         gen temp_delta_rho = (temp_lon - longitude)
  8. }
type mismatch
r(109);

end of do-file

r(109);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         gen temp_delta_phi = (temp_lat - latitude) * _pi/180;
  8.         gen temp_delta_rho = (temp_lon - longitude)
  9. }
temp_lat: all characters numeric; replaced as double
180; invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         gen temp_delta_phi = (temp_lat - latitude) * _pi/180;
  9.         gen temp_delta_rho = (temp_lon - longitude)
 10. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
180; invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         gen temp_delta_phi = (temp_lat - latitude) * _pi/180;
  9.         gen temp_delta_rho = (temp_lon - longitude) * _pi/180;
 10. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
180; invalid name
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         gen temp_delta_phi = (temp_lat - latitude) * _pi/180
  9.         gen temp_delta_rho = (temp_lon - longitude) * _pi/180
 10. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         gen temp_delta_phi = (temp_lat - latitude) * _pi/180
  9.         gen temp_delta_rho = (temp_lon - longitude) * _pi/180
 10. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
variable temp_lat already defined
r(110);

end of do-file

r(110);

. use "$MyProject/processed/zip_code_centroids.dta", clear

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         gen temp_delta_phi = (temp_lat - latitude) * _pi/180
  9.         gen temp_delta_rho = (temp_lon - longitude) * _pi/180
 10.         ldksdnl
 11. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
command ldksdnl is unrecognized
r(199);

end of do-file

r(199);

. const rad = 3958.8
invalid syntax
r(198);

. global rad = 3958.8

. di `rad'


. di "`rad'"


. rad
command rad is unrecognized
r(199);

. `rad'
. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)**2
 13.         gen b = cos(temp_lat)*cos(latitude)
 14.         gen c = sin(delta_lambda/2)**2
 15.         gen dist_disp_`i' = 2 * 3958.8 * asin(sqrt(a + b * c))
 16.         ldksdnl
 17. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
unknown function ()
r(133);

end of do-file

r(133);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)**2
 13. //      gen b = cos(temp_lat)*cos(latitude)
. //      gen c = sin(delta_lambda/2)**2
. //      gen dist_disp_`i' = 2 * 3958.8 * asin(sqrt(a + b * c))
. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
unknown function ()
r(133);

end of do-file

r(133);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)*sin(delta_phi)
 13. //      gen b = cos(temp_lat)*cos(latitude)
. //      gen c = sin(delta_lambda/2)**2
. //      gen dist_disp_`i' = 2 * 3958.8 * asin(sqrt(a + b * c))
. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)*sin(delta_phi)
 13.         gen b = cos(temp_lat)*cos(latitude)
 14. //      gen c = sin(delta_lambda/2)**2
. //      gen dist_disp_`i' = 2 * 3958.8 * asin(sqrt(a + b * c))
. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)*sin(delta_phi)
 13.         gen b = cos(temp_lat)*cos(latitude)
 14.         gen c = sin(delta_lambda/2)*sin(delta_lambda/2)
 15. //      gen dist_disp_`i' = 2 * 3958.8 * asin(sqrt(a + b * c))
. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)*sin(delta_phi)
 13.         gen b = cos(temp_lat)*cos(latitude)
 14.         gen c = sin(delta_lambda/2)*sin(delta_lambda/2)
 15.         gen dist_disp_`i' = 2 * 3958.8 * asin(sqrt(a + b * c))
 16. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
(566 missing values generated)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)*sin(delta_phi)
 13.         gen b = cos(temp_lat)*cos(latitude)
 14.         gen c = sin(delta_lambda/2)*sin(delta_lambda/2)
 15.         gen dist_disp_`i' = a + b * c
 16. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)^2
 13.         gen b = cos(temp_lat)*cos(latitude)
 14.         gen c = sin(delta_lambda/2)*sin(delta_lambda/2)
 15.         gen dist_disp_`i' = a + b * c
 16. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)^2
 13.         gen b = cos(temp_lat)*cos(latitude)
 14.         gen c = sin(delta_lambda/2)^2
 15.         gen dist_disp_`i' = a + b * c
 16. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)^2
 13.         gen b = cos(temp_lat)*cos(latitude)
 14.         gen c = sin(delta_lambda/2)^2
 15.         gen dist_disp_`i' = a + b * c
 16. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen a = sin(delta_phi/2)^2
 13.         gen b = cos(temp_lat)*cos(latitude)
 14.         gen c = sin(delta_lambda/2)^2
 15.         gen dist_disp_`i' = sqrt(a + b * c)
 16. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen dist_disp_`i' = sqrt(sin(delta_phi/2)^2 + cos(temp_lat)*cos(latitude)*sin(delta_lambda/2)^2)
 13. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, replace
  7.         destring temp_lon, replace
  8.         replace temp_lat = temp_lat * _pi/180
  9.         replace temp_lon = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen dist_disp_`i' = asin(sqrt(sin(delta_phi/2)^2 + cos(temp_lat)*cos(latitude)*sin(delta_lambda/2)^2))
 13. //      ldksdnl
. }
temp_lat: all characters numeric; replaced as double
temp_lon: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable temp_lat already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, gen phi_1
  7.         destring temp_lon, gen phi_2
  8.         replace phi_1 = temp_lat * _pi/180
  9.         replace phi_2 = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen dist_disp_`i' = asin(sqrt(sin(delta_phi/2)^2 + cos(temp_lat)*cos(latitude)*sin(delta_lambda/2)^2))
 13. }
option gen incorrectly specified
r(198);

end of do-file

r(198);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, gen(phi_1)
  7.         destring temp_lon, gen(phi_2)
  8.         replace phi_1 = temp_lat * _pi/180
  9.         replace phi_2 = temp_lon * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen dist_disp_`i' = asin(sqrt(sin(delta_phi/2)^2 + cos(temp_lat)*cos(latitude)*sin(delta_lambda/2)^2))
 13. }
temp_lat: all characters numeric; phi_1 generated as double
temp_lon: all characters numeric; phi_2 generated as double
type mismatch
r(109);

end of do-file

r(109);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, gen(phi_1)
  7.         destring temp_lon, gen(phi_2)
  8.         replace phi_1 = phi_1 * _pi/180
  9.         replace phi_2 = phi_2 * _pi/180
 10.         gen delta_phi = temp_lat - latitude
 11.         gen delta_lambda = temp_lon - longitude
 12.         gen dist_disp_`i' = asin(sqrt(sin(delta_phi/2)^2 + cos(temp_lat)*cos(latitude)*sin(delta_lambda/2)^2))
 13. }
temp_lat: all characters numeric; phi_1 generated as double
temp_lon: all characters numeric; phi_2 generated as double
(576 real changes made)
(576 real changes made)
type mismatch
r(109);

end of do-file

r(109);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen temp_lat = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen temp_lon = substr("`disp_loc'", `pos', .)
  6.         destring temp_lat, gen(phi)
  7.         destring temp_lon, gen(lambda)
  8.         replace phi = phi * _pi/180
  9.         replace lambda = lambda * _pi/180
 10.         gen delta_phi = phi - (latitude * _pi/180)
 11.         gen delta_lambda = lambda - (longitude * _pi/180)
 12.         gen dist_disp_`i' = asin(sqrt(sin(delta_phi/2)^2 + cos(temp_lat)*cos(latitude)*sin(delta_lambda/2)^2))
 13. }
temp_lat: all characters numeric; phi generated as double
temp_lon: all characters numeric; lambda generated as double
(576 real changes made)
(576 real changes made)
type mismatch
r(109);

end of do-file

r(109);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen phi_1 = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen lambda_1 = substr("`disp_loc'", `pos', .)
  6.         destring phi_1, replace
  7.         destring lambda_1, replace
  8.         replace phi_1 = phi_1 * _pi/180
  9.         replace lambda_1 = lambda_1 * _pi/180
 10.         gen phi_2 = latitude * _pi/180
 11.         gen lambda_2 = longitude * _pi/180
 12.         gen delta_phi = phi_1 - phi_2
 13.         gen delta_lambda = lambda1 - lambda_2
 14.         gen dist_disp_`i' = asin(sqrt(sin(delta_phi/2)^2 + cos(temp_lat)*cos(latitude)*sin(delta_lambda/2)^2))
 15. }
phi_1: all characters numeric; replaced as double
lambda_1: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
lambda1 not found
r(111);

end of do-file

r(111);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen phi_1 = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen lambda_1 = substr("`disp_loc'", `pos', .)
  6.         destring phi_1, replace
  7.         destring lambda_1, replace
  8.         replace phi_1 = phi_1 * _pi/180
  9.         replace lambda_1 = lambda_1 * _pi/180
 10.         gen phi_2 = latitude * _pi/180
 11.         gen lambda_2 = longitude * _pi/180
 12.         gen delta_phi = phi_1 - phi_2
 13.         gen delta_lambda = lambda_1 - lambda_2
 14.         gen dist_disp_`i' = asin(sqrt(sin(delta_phi/2)^2 + cos(temp_lat)*cos(latitude)*sin(delta_lambda/2)^2))
 15. }
phi_1: all characters numeric; replaced as double
lambda_1: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
temp_lat not found
r(111);

end of do-file

r(111);

. do "/var/folders/f8/b0yvw63s7q32wx1k476bz7t00000gn/T//SD04554.000000"

.         gen dist_disp_`i' = asin(sqrt(sin(delta_phi/2)^2 + cos(lambda_1)*cos(lambda_2)*sin(delta_lambda/2)^2))

. 
end of do-file

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen phi_1 = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen lambda_1 = substr("`disp_loc'", `pos', .)
  6.         destring phi_1, replace
  7.         destring lambda_1, replace
  8.         replace phi_1 = phi_1 * _pi/180
  9.         replace lambda_1 = lambda_1 * _pi/180
 10.         gen phi_2 = latitude * _pi/180
 11.         gen lambda_2 = longitude * _pi/180
 12.         gen delta_phi = phi_1 - phi_2
 13.         gen delta_lambda = lambda_1 - lambda_2
 14.         gen dist_disp_`i' = 2 * 3958.8 * asin(sqrt(sin(delta_phi/2)^2 + cos(lambda_1)*cos(lambda_2)*sin(delta_lambda/2)^2))
 15. }
phi_1: all characters numeric; replaced as double
lambda_1: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable phi_1 already defined
r(110);

end of do-file

r(110);

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/scripts/2i_clean_zip_codes_data.do"

. ************
. * SCRIPT: 2i_clean_zip_codes_data.do
. * PURPOSE: processes the zip code centroids dataset in preparation for analysis
. ************
. 
. use "$MyProject/processed/intermediate/zip_code_centroids_uncleaned.dta", clear

. 
. * Keep only zip codes in Massachusetts
. keep if usps_zip_pref_state_1221=="MA"
(34,776 observations deleted)

. 
. * Select only desired columns
. keep std_zip5 usps_zip_pref_city_1221 usps_zip_pref_state_1221 latitude longitude

. 
. * Rename columns
. rename std_zip5 zipcode

. rename usps_zip_pref_city_1221 city

. rename usps_zip_pref_state_1221 state

. 
. * Make zipcode type string
. tostring zipcode, replace
zipcode was long now str4

. replace zipcode = "0" + zipcode
variable zipcode was str4 now str5
(576 real changes made)

. 
. * Save dataset
. compress
  variable city was str26 now str18
  (4,608 bytes saved)

. save "$MyProject/processed/zip_code_centroids.dta", replace
file /Users/anniebryan/Documents/College/2021-22/14.33/Project/processed/zip_code_centroids.dta saved

. 
. * Get distance to dispensaries
. use "$MyProject/processed/dispensaries_boston.dta", clear

. egen lat_lon = concat(latitude longitude), punct(" ")

. levelsof lat_lon, local(disp_locs)
`"42.30654 -71.05796"' `"42.30969 -71.0822"' `"42.32167 -71.11039"' `"42.33174 -71.11803"' `"42.34157 -71.12223"' `"42.34559 -71.09985"' `"42.35149 -71.12183"' `"42.35665 -71.0582
> 7"' `"42.36466 -71.06143"' `"42.3761 -71.03889"' `"42.38799 -71.01782"'

. 
. use "$MyProject/processed/zip_code_centroids.dta", clear

. di `disp_locs'
42.30654 -71.0579642.30969 -71.082242.32167 -71.1103942.33174 -71.1180342.34157 -71.1222342.34559 -71.0998542.35149 -71.1218342.35665 -71.0582742.36466 -71.0614342.3761 -71.038894
> 2.38799 -71.01782

. local i = 0

. foreach disp_loc of local disp_locs {
  2.         local i = `i' + 1
  3.         local pos = strpos("`disp_loc'", " ") + 1
  4.         gen phi_1 = substr("`disp_loc'", 1, `pos' - 2)
  5.     gen lambda_1 = substr("`disp_loc'", `pos', .)
  6.         destring phi_1, replace
  7.         destring lambda_1, replace
  8.         replace phi_1 = phi_1 * _pi/180
  9.         replace lambda_1 = lambda_1 * _pi/180
 10.         gen phi_2 = latitude * _pi/180
 11.         gen lambda_2 = longitude * _pi/180
 12.         gen delta_phi = phi_1 - phi_2
 13.         gen delta_lambda = lambda_1 - lambda_2
 14.         gen dist_disp_`i' = 12742 * asin(sqrt(sin(delta_phi/2)^2 + cos(lambda_1)*cos(lambda_2)*sin(delta_lambda/2)^2))
 15. }
phi_1: all characters numeric; replaced as double
lambda_1: all characters numeric; replaced as double
(576 real changes made)
(576 real changes made)
variable phi_1 already defined
r(110);

end of do-file

r(110);

. ssc install geodist
checking geodist consistency and verifying not already installed...
installing into /Users/anniebryan/Library/Application Support/Stata/ado/plus/...
installation complete.

. do "/Users/anniebryan/Documents/College/2021-22/14.33/Project/run.do"

. **********************
. * OVERVIEW
. *   All raw data are stored in /data
. *   All tables are outputted to /results/tables
. *   All figures are outputted to /results/figures
. *
. * TO PERFORM A CLEAN RUN, DELETE THE FOLLOWING TWO FOLDERS:
. *   /processed
. *   /results
. **********************
. 
. global MyProject "/Users/anniebryan/Documents/College/2021-22/14.33/Project"

. 
. * Initialize log
. clear

. set more off

. cap mkdir "$MyProject/scripts/logs"

. cap log close
